name: CI
on: push

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with:
        submodules: recursive
    - uses: ATiltedTree/setup-rust@v1
      with:
        rust-version: stable
    - run: sudo apt install sbcl cl-quicklisp
    - run: sbcl --load /usr/share/common-lisp/source/quicklisp/quicklisp.lisp --eval "(quicklisp-quickstart:install)" --eval "(ql-util:without-prompting)" --eval "(ql:add-to-init-file)"
    - run: ln -s $PWD ~/quicklisp/local-projects
    - run: make
